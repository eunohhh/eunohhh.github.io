(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();const p=document.getElementById("cards_wrapper"),f=document.getElementById("search_input"),M=document.querySelector(".search_submit"),v=document.querySelector(".lang_change"),I=document.getElementById("top_button"),L=document.body;let l="",b=!1,i=1,d="ko",h={page:0,results:[],total_pages:0,total_results:0},g=[];const w=async(t,e)=>{let r={},s="";t==="ko"?s="ko-kr":t==="en"&&(s="en-US");const n=`https://api.themoviedb.org/3/movie/top_rated?language=${s}&page=${e}`,o={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJiZTMzNGMzYmY5YzU0MzVhOWU4MDZkMmI3NDlhMmM5MSIsInN1YiI6IjY2MjViMWFjZWI3OWMyMDE3ZWQzZjY4YyIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.GEfKvRKY7frVeo_dDiR84gHShsAMWhaDGnfxBePSaBE"}};try{const a=await fetch(n,o);if(!a.ok)throw new Error("서버 응답 실패");const c=await a.json();return e>0?(r={page:c.page,results:[...h.results,...c.results],total_pages:c.total_pages,total_results:c.total_results},g=[...h.results,...c.results]):(r=c,g=[...c.results]),h=r,c}catch(a){console.log(a)}},E=(t,e,r=!1)=>`
            <div class='card ${r?"modal-card":""}' data-id=${t.id}>
                <div class='movie_poster_box'>
                    <img src='https://image.tmdb.org/t/p/w500${t.poster_path}' alt='poster' />
                </div>
                <div class='movie_info'>
                    <h2>${t.title}</h2>
                    <span>평점 : ${e}</span>
                    <p>${t.overview}</p>
                </div>
            </div>
        `,y=(t,e)=>t.map((n,o)=>{const a=Math.round(n.vote_average*10)/10;return E(n,a,e)}).join(""),u=async(t,e)=>{e&&(p.innerHTML="");const r=await w(t,String(i)),s=y(r.results,!1);return p.insertAdjacentHTML("beforeend",s),r},j=(t,e)=>{if(e.length===0){alert("검색어를 입력하세요!");return}const r=g.filter(s=>s.title.includes(e));return r.length>0?r:[]},k=()=>{const t=document.createElement("div");t.setAttribute("class","searched_modal");const e='<div class="searched_inner"></div>';return t.insertAdjacentHTML("beforeend",e),L.insertAdjacentElement("afterbegin",t),t},_=(t,e)=>{const r=j(t,e);if(!r)return;if(r.length===0){alert("검색결과가 없습니다!");return}const s=k(),n=y(r,!0);s.addEventListener("click",o=>{o.target.className==="searched_inner"&&o.currentTarget.remove()}),s.firstChild.insertAdjacentHTML("beforeend",n)},O=(t,e,r)=>{const s=document.querySelector(".searched_modal");t.key==="Enter"&&!e?(_(t,r),e=!0):s&&(e=!1)},B=t=>{const e=t.target.closest(".card");if(e){const r=e.dataset.id;alert(`영화의 ID 는 : ${r} 입니다.`)}},m=t=>{const e=document.querySelectorAll(".card"),r=e[e.length-1];t.observe(r)},S=(t,e)=>{t.forEach(async r=>{const{target:s}=r;r.isIntersecting&&(e.unobserve(s),i++,await u(d,!1),m(e))})},T=async(t,e,r)=>{const s=r.dataset.lang;s==="ko"?(i=1,r.dataset.lang="en",d="en",await u("en",!0),m(e)):s==="en"&&(i=1,r.dataset.lang="ko",d="ko",await u("ko",!0),m(e))},A=t=>{let e=t.target.value;/[a-zA-Z]/.test(e)?l=e.toLowerCase():l=e},C=()=>{window.scrollTo({left:0,top:0,behavior:"smooth"})},H=async()=>{await u(d,!1),I.addEventListener("click",C),f.focus();const t=new IntersectionObserver((e,r)=>S(e,r));m(t),v.addEventListener("click",e=>T(e,t,v)),p.addEventListener("click",B),f.addEventListener("input",A),M.addEventListener("click",e=>_(e,l)),f.addEventListener("keydown",e=>O(e,b,l))};H();
