(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const y=document.getElementById("cards_wrapper"),l=document.getElementById("search_input"),w=document.querySelector(".search_submit"),d=document.querySelector(".lang_change"),b=document.getElementById("top_button"),p=d.lastElementChild,g=d.firstElementChild,E=document.body;let u="",S=!1,L=1,h="ko",v={page:0,results:[],total_pages:0,total_results:0},_=[];function x(){const t=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${t}px`)}function T(){window.dispatchEvent(new Event("resize"))}const j=async(t,e)=>{const n=String(e);let s={},r="";t==="ko"?r="ko-kr":t==="en"&&(r="en-US");const o=`https://api.themoviedb.org/3/movie/top_rated?language=${r}&page=${n}`,c={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJiZTMzNGMzYmY5YzU0MzVhOWU4MDZkMmI3NDlhMmM5MSIsInN1YiI6IjY2MjViMWFjZWI3OWMyMDE3ZWQzZjY4YyIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.GEfKvRKY7frVeo_dDiR84gHShsAMWhaDGnfxBePSaBE"}};try{const i=await fetch(o,c);if(!i.ok)throw new Error("서버 응답 실패");const a=await i.json();return e===1?(s=a,_=[...a.results]):(s={page:a.page,results:[...v.results,...a.results],total_pages:a.total_pages,total_results:a.total_results},_=[...v.results,...a.results]),v=s,a}catch(i){console.log(i)}},k=(t,e,n=!1)=>`
            <div class='card ${n?"modal-card":""}' data-id=${t.id}>
                <div class='movie_poster_box'>
                    <img src='https://image.tmdb.org/t/p/w500${t.poster_path}' alt='poster' />
                </div>
                <div class='movie_info'>
                    <h2>${t.title}</h2>
                    <span>평점 : ${e}</span>
                    <p>${t.overview}</p>
                </div>
            </div>
        `,M=(t,e)=>t.map((r,o)=>{const c=Math.round(r.vote_average*10)/10;return k(r,c,e)}).join(""),m=async(t,e)=>{e&&(y.innerHTML="");const n=await j(t,L),s=M(n.results,!1);return y.insertAdjacentHTML("beforeend",s),n},O=()=>{E.style.overflowY="hidden";const t=document.createElement("div");t.setAttribute("class","searched_modal");const e='<div class="searched_inner"></div>';return t.insertAdjacentHTML("beforeend",e),E.insertAdjacentElement("afterbegin",t),t},I=(t,e)=>{const n=C(t,e);if(!n)return;if(n.length===0){alert("검색결과가 없습니다!");return}const s=O(),r=M(n,!0);s.addEventListener("click",o=>{E.style.overflowY="auto",(o.target.className==="searched_modal"||o.target.className==="searched_inner")&&o.currentTarget.remove()}),s.firstChild.insertAdjacentHTML("beforeend",r)},z=(t,e,n)=>{const s=document.querySelector(".searched_modal");t.key==="Enter"&&!e?(I(t,n),e=!0):s&&(e=!1)},B=t=>{const e=t.target.closest(".card");if(e){const n=e.dataset.id;alert(`영화의 ID 는 : ${n} 입니다.`)}},C=(t,e)=>{if(e.length===0){alert("검색어를 입력하세요!");return}const n=_.filter(s=>s.title.includes(e));return n.length>0?n:[]},f=t=>{const e=document.querySelectorAll(".card"),n=e[e.length-1];t.observe(n)},A=(t,e)=>{t.forEach(async n=>{const{target:s}=n;n.isIntersecting&&(L++,e.unobserve(s),await m(h,!1),f(e))})},H=async(t,e,n)=>{const s=n.dataset.lang,r=document.querySelector("header h1");L=1,s==="ko"?(n.dataset.lang="en",h="en",await m("en",!0),f(e),r.innerText="movieAllmovies",l.placeholder="Let's Search for A Movie",w.innerText="search",g.style.textShadow="1px 1px 2px white, 0 0 1em white, 0 0 0.2em white",g.style.color="white",p.style.color="#cfcfcf"):s==="en"&&(n.dataset.lang="ko",h="ko",await m("ko",!0),f(e),r.innerText="영화다영화",l.placeholder="영화를 검색해보자",w.innerText="검색",p.style.textShadow="1px 1px 2px white, 0 0 1em white, 0 0 0.2em white",p.style.color="white",g.style.color="#cfcfcf")},$=t=>{let e=t.target.value;/[a-zA-Z]/.test(e)?u=e.toLowerCase():u=e},N=()=>{window.scrollTo({left:0,top:0,behavior:"smooth"})},W=async()=>{window.addEventListener("orientationchange",T,!1),window.addEventListener("resize",x),window.dispatchEvent(new Event("resize")),await m(h,!1),b.addEventListener("click",N),l.focus();const t=new IntersectionObserver((e,n)=>A(e,n),{threshold:.8});f(t),d.addEventListener("click",e=>H(e,t,d)),y.addEventListener("click",B),l.addEventListener("input",$),w.addEventListener("click",e=>I(e,u)),l.addEventListener("keydown",e=>z(e,S,u))};W();
