(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();const y=document.getElementById("cards_wrapper"),l=document.getElementById("search_input"),w=document.querySelector(".search_submit"),i=document.querySelector(".lang_change"),E=document.getElementById("top_button"),p=i.lastElementChild,g=i.firstElementChild,I=document.body;let d="",b=!1,u=1,h="ko",v={page:0,results:[],total_pages:0,total_results:0},_=[];const x=async(t,e)=>{let r={},n="";t==="ko"?n="ko-kr":t==="en"&&(n="en-US");const s=`https://api.themoviedb.org/3/movie/top_rated?language=${n}&page=${e}`,o={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJiZTMzNGMzYmY5YzU0MzVhOWU4MDZkMmI3NDlhMmM5MSIsInN1YiI6IjY2MjViMWFjZWI3OWMyMDE3ZWQzZjY4YyIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.GEfKvRKY7frVeo_dDiR84gHShsAMWhaDGnfxBePSaBE"}};try{const a=await fetch(s,o);if(!a.ok)throw new Error("서버 응답 실패");const c=await a.json();return e===0?(r=c,_=[...c.results]):(r={page:c.page,results:[...v.results,...c.results],total_pages:c.total_pages,total_results:c.total_results},_=[...v.results,...c.results]),v=r,c}catch(a){console.log(a)}},S=(t,e,r=!1)=>`
            <div class='card ${r?"modal-card":""}' data-id=${t.id}>
                <div class='movie_poster_box'>
                    <img src='https://image.tmdb.org/t/p/w500${t.poster_path}' alt='poster' />
                </div>
                <div class='movie_info'>
                    <h2>${t.title}</h2>
                    <span>평점 : ${e}</span>
                    <p>${t.overview}</p>
                </div>
            </div>
        `,M=(t,e)=>t.map((s,o)=>{const a=Math.round(s.vote_average*10)/10;return S(s,a,e)}).join(""),m=async(t,e)=>{e&&(y.innerHTML="");const r=await x(t,String(u)),n=M(r.results,!1);return y.insertAdjacentHTML("beforeend",n),r},T=()=>{const t=document.createElement("div");t.setAttribute("class","searched_modal");const e='<div class="searched_inner"></div>';return t.insertAdjacentHTML("beforeend",e),I.insertAdjacentElement("afterbegin",t),t},L=(t,e)=>{const r=O(t,e);if(!r)return;if(r.length===0){alert("검색결과가 없습니다!");return}const n=T(),s=M(r,!0);n.addEventListener("click",o=>{console.log(o.target.className),(o.target.className==="searched_modal"||o.target.className==="searched_inner")&&o.currentTarget.remove()}),n.firstChild.insertAdjacentHTML("beforeend",s)},j=(t,e,r)=>{const n=document.querySelector(".searched_modal");t.key==="Enter"&&!e?(L(t,r),e=!0):n&&(e=!1)},k=t=>{const e=t.target.closest(".card");if(e){const r=e.dataset.id;alert(`영화의 ID 는 : ${r} 입니다.`)}},O=(t,e)=>{if(e.length===0){alert("검색어를 입력하세요!");return}const r=_.filter(n=>n.title.includes(e));return r.length>0?r:[]},f=t=>{const e=document.querySelectorAll(".card"),r=e[e.length-1];t.observe(r)},B=(t,e)=>{t.forEach(async r=>{const{target:n}=r;r.isIntersecting&&(u++,e.unobserve(n),await m(h,!1),f(e))})},A=async(t,e,r)=>{const n=r.dataset.lang,s=document.querySelector("header h1");n==="ko"?(u=1,r.dataset.lang="en",h="en",await m("en",!0),f(e),s.innerText="movieAllmovies",l.placeholder="Let's Search for A Movie",w.innerText="search",g.style.textShadow="1px 1px 2px white, 0 0 1em white, 0 0 0.2em white",g.style.color="white",p.style.color="#cfcfcf"):n==="en"&&(u=1,r.dataset.lang="ko",h="ko",await m("ko",!0),f(e),s.innerText="영화다영화",l.placeholder="영화를 검색해보자",w.innerText="검색",p.style.textShadow="1px 1px 2px white, 0 0 1em white, 0 0 0.2em white",p.style.color="white",g.style.color="#cfcfcf")},C=t=>{let e=t.target.value;/[a-zA-Z]/.test(e)?d=e.toLowerCase():d=e},H=()=>{window.scrollTo({left:0,top:0,behavior:"smooth"})},N=async()=>{await m(h,!1),E.addEventListener("click",H),l.focus();const t=new IntersectionObserver((e,r)=>B(e,r),{threshold:.9});f(t),i.addEventListener("click",e=>A(e,t,i)),y.addEventListener("click",k),l.addEventListener("input",C),w.addEventListener("click",e=>L(e,d)),l.addEventListener("keydown",e=>j(e,b,d))};N();
