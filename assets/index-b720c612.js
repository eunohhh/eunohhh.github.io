(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const y=document.getElementById("cards_wrapper"),i=document.getElementById("search_input"),w=document.querySelector(".search_submit"),l=document.querySelector(".lang_change"),M=document.getElementById("top_button"),p=l.lastElementChild,g=l.firstElementChild,I=document.body;let d="",b=!1,u=1,h="ko",v={page:0,results:[],total_pages:0,total_results:0},E=[];function S(){const t=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${t}px`)}function x(){window.dispatchEvent(new Event("resize"))}const T=async(t,e)=>{let n={},s="";t==="ko"?s="ko-kr":t==="en"&&(s="en-US");const r=`https://api.themoviedb.org/3/movie/top_rated?language=${s}&page=${e}`,o={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJiZTMzNGMzYmY5YzU0MzVhOWU4MDZkMmI3NDlhMmM5MSIsInN1YiI6IjY2MjViMWFjZWI3OWMyMDE3ZWQzZjY4YyIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.GEfKvRKY7frVeo_dDiR84gHShsAMWhaDGnfxBePSaBE"}};try{const a=await fetch(r,o);if(!a.ok)throw new Error("서버 응답 실패");const c=await a.json();return e===0?(n=c,E=[...c.results]):(n={page:c.page,results:[...v.results,...c.results],total_pages:c.total_pages,total_results:c.total_results},E=[...v.results,...c.results]),v=n,c}catch(a){console.log(a)}},j=(t,e,n=!1)=>`
            <div class='card ${n?"modal-card":""}' data-id=${t.id}>
                <div class='movie_poster_box'>
                    <img src='https://image.tmdb.org/t/p/w500${t.poster_path}' alt='poster' />
                </div>
                <div class='movie_info'>
                    <h2>${t.title}</h2>
                    <span>평점 : ${e}</span>
                    <p>${t.overview}</p>
                </div>
            </div>
        `,_=(t,e)=>t.map((r,o)=>{const a=Math.round(r.vote_average*10)/10;return j(r,a,e)}).join(""),m=async(t,e)=>{e&&(y.innerHTML="");const n=await T(t,String(u)),s=_(n.results,!1);return y.insertAdjacentHTML("beforeend",s),n},k=()=>{const t=document.createElement("div");t.setAttribute("class","searched_modal");const e='<div class="searched_inner"></div>';return t.insertAdjacentHTML("beforeend",e),I.insertAdjacentElement("afterbegin",t),t},L=(t,e)=>{const n=B(t,e);if(!n)return;if(n.length===0){alert("검색결과가 없습니다!");return}const s=k(),r=_(n,!0);s.addEventListener("click",o=>{console.log(o.target.className),(o.target.className==="searched_modal"||o.target.className==="searched_inner")&&o.currentTarget.remove()}),s.firstChild.insertAdjacentHTML("beforeend",r)},O=(t,e,n)=>{const s=document.querySelector(".searched_modal");t.key==="Enter"&&!e?(L(t,n),e=!0):s&&(e=!1)},z=t=>{const e=t.target.closest(".card");if(e){const n=e.dataset.id;alert(`영화의 ID 는 : ${n} 입니다.`)}},B=(t,e)=>{if(e.length===0){alert("검색어를 입력하세요!");return}const n=E.filter(s=>s.title.includes(e));return n.length>0?n:[]},f=t=>{const e=document.querySelectorAll(".card"),n=e[e.length-1];t.observe(n)},C=(t,e)=>{t.forEach(async n=>{const{target:s}=n;n.isIntersecting&&(u++,e.unobserve(s),await m(h,!1),f(e))})},A=async(t,e,n)=>{const s=n.dataset.lang,r=document.querySelector("header h1");s==="ko"?(u=1,n.dataset.lang="en",h="en",await m("en",!0),f(e),r.innerText="movieAllmovies",i.placeholder="Let's Search for A Movie",w.innerText="search",g.style.textShadow="1px 1px 2px white, 0 0 1em white, 0 0 0.2em white",g.style.color="white",p.style.color="#cfcfcf"):s==="en"&&(u=1,n.dataset.lang="ko",h="ko",await m("ko",!0),f(e),r.innerText="영화다영화",i.placeholder="영화를 검색해보자",w.innerText="검색",p.style.textShadow="1px 1px 2px white, 0 0 1em white, 0 0 0.2em white",p.style.color="white",g.style.color="#cfcfcf")},H=t=>{let e=t.target.value;/[a-zA-Z]/.test(e)?d=e.toLowerCase():d=e},N=()=>{window.scrollTo({left:0,top:0,behavior:"smooth"})},$=async()=>{window.addEventListener("orientationchange",x,!1),window.addEventListener("resize",S),window.dispatchEvent(new Event("resize")),await m(h,!1),M.addEventListener("click",N),i.focus();const t=new IntersectionObserver((e,n)=>C(e,n),{threshold:.8});f(t),l.addEventListener("click",e=>A(e,t,l)),y.addEventListener("click",z),i.addEventListener("input",H),w.addEventListener("click",e=>L(e,d)),i.addEventListener("keydown",e=>O(e,b,d))};$();
