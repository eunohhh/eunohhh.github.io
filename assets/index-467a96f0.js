(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=e(n);fetch(n.href,o)}})();const h=document.getElementById("cards_wrapper"),g=document.getElementById("search_input"),M=document.querySelector(".search_submit"),v=document.querySelector(".lang_change"),I=document.getElementById("top_button"),L=document.body;let m="",b=!1,i=1,l="ko",f={page:0,results:[],total_pages:0,total_results:0},p=[];const E=async(r,t)=>{let e={},s="";r==="ko"?s="ko-kr":r==="en"&&(s="en-US");const n=`https://api.themoviedb.org/3/movie/top_rated?language=${s}&page=${t}`,o={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJiZTMzNGMzYmY5YzU0MzVhOWU4MDZkMmI3NDlhMmM5MSIsInN1YiI6IjY2MjViMWFjZWI3OWMyMDE3ZWQzZjY4YyIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.GEfKvRKY7frVeo_dDiR84gHShsAMWhaDGnfxBePSaBE"}};try{const a=await fetch(n,o);if(!a.ok)throw new Error("서버 응답 실패");const c=await a.json();return t>0?(e={page:c.page,results:[...f.results,...c.results],total_pages:c.total_pages,total_results:c.total_results},p=[...f.results,...c.results]):(e=c,p=[...c.results]),f=e,c}catch(a){console.log(a)}},w=(r,t,e=!1)=>`
            <div class='card ${e?"modal-card":""}' data-id=${r.id}>
                <div class='movie_poster_box'>
                    <img src='https://image.tmdb.org/t/p/w500${r.poster_path}' alt='poster' />
                </div>
                <div class='movie_info'>
                    <h2>${r.title}</h2>
                    <span>평점 : ${t}</span>
                    <p>${r.overview}</p>
                </div>
            </div>
        `,y=(r,t)=>r.map((n,o)=>{const a=Math.round(n.vote_average*10)/10;return w(n,a,t)}).join(""),d=async(r,t)=>{t&&(h.innerHTML="");const e=await E(r,String(i)),s=y(e.results,!1);return h.insertAdjacentHTML("beforeend",s),e},j=(r,t)=>{if(t.length===0){alert("검색어를 입력하세요!");return}const e=p.filter(s=>s.title.includes(t));return e.length>0?e:[]},k=()=>{const r=document.createElement("div");r.setAttribute("class","searched_modal");const t='<div class="searched_inner"></div>';return r.insertAdjacentHTML("beforeend",t),L.insertAdjacentElement("afterbegin",r),r},_=(r,t)=>{const e=j(r,t);if(!e)return;if(e.length===0){alert("검색결과가 없습니다!");return}const s=k(),n=y(e,!0);s.addEventListener("click",o=>{o.target.className==="searched_inner"&&o.currentTarget.remove()}),s.firstChild.insertAdjacentHTML("beforeend",n)},O=(r,t,e)=>{const s=document.querySelector(".searched_modal");r.key==="Enter"&&!t?(_(r,e),t=!0):s&&(t=!1)},B=r=>{const t=r.target.closest(".card");if(t){const e=t.dataset.id;alert(`영화의 ID 는 : ${e} 입니다.`)}},u=r=>{const t=document.querySelectorAll(".card"),e=t[t.length-1];r.observe(e)},S=(r,t)=>{r.forEach(async e=>{const{target:s}=e;e.isIntersecting&&(t.unobserve(s),i++,await d(l,!1),u(t))})},T=async(r,t,e)=>{const s=e.dataset.lang;s==="ko"?(i=1,e.dataset.lang="en",l="en",await d("en",!0),u(t)):s==="en"&&(i=1,e.dataset.lang="ko",l="ko",await d("ko",!0),u(t))},H=()=>{window.scrollTo({left:0,top:0,behavior:"smooth"})},W=async()=>{await d(l,!1),I.addEventListener("click",H);const r=new IntersectionObserver((e,s)=>S(e,s));u(r),v.addEventListener("click",e=>T(e,r,v)),h.addEventListener("click",B);const t=e=>m=e.target.value;g.addEventListener("input",t),M.addEventListener("click",e=>_(e,m)),g.addEventListener("keydown",e=>O(e,b,m))};W();
